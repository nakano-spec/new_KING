<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>表示２</title>
    <link type="text/css" rel="stylesheet" href="/stylesheets/index.css">
    <style>
      #picture {
          text-align: center;
      }
      #picture img {
          max-width: 100%;
          height: auto;
      }
    </style>
  </head>
  <header>
    <div style="display: flex; align-items: center;">
        <div class="menu-icon">
            <div></div>
            <div></div>
            <div></div>
        </div>
        <span class="header-title">ニコキタ教育委員会：問題表示</span>
    </div>
    <div class="user-info">ユーザー</div>
</header>
  <body>
    <script src='/socket.io/socket.io.js'></script>

    <!-- タイマーと問題表示用のHTML -->
    <div id="mytime"></div>
    <div class="timer">
      <div id="re" class="hun"></div>
      <div id="re2" class="ti">:</div>
      <div id="re3" class="byou"></div>
    </div>
    <h1 id="questionText"><%= question_text %></h1>
    <div id="picture" class="picture"> <% if (pics_name) { %>
      <p></p>
      <img src="/images/<%= pics_name %>" alt="問題画像" />
  <% } else { %>
  <% } %></div>

    <script>
      var socket = io();
      const limit_time = '<%= limit_time %>';
      console.log(limit_time);
      var totalSeconds = parseInt(limit_time, 10);
        var minutes = Math.floor(totalSeconds / 60);
        var seconds = totalSeconds % 60;

        // タイマーの表示更新
        document.getElementById('re').innerText = minutes;
        document.getElementById('re3').innerText = seconds;

        var countdownId = setInterval(function() {
          if (minutes === 0 && seconds === 0) {
            clearInterval(countdownId);
          } else {
            if (seconds === 0) {
              minutes--;
              seconds = 59;
            } else {
              seconds--;
            }
            document.getElementById('re').innerText = minutes;
            document.getElementById('re3').innerText = seconds;
          }
        }, 1000);

        // 他のページへの遷移処理
      socket.on('hyouji', function(de) {
        window.location.href = '/hyou3?data=' + encodeURIComponent(de);
      });

      socket.on('result_display2', function(data) {
        window.location.href = '/hyou4';
      });
      /*socket.on('problem_display_data', function(data) {
        // 問題テキストを表示
        document.getElementById('questionText').innerText = question_text;
        // 画像がある場合の処理
        if (pics_name) {
          var imgElement = document.createElement('img');
          imgElement.src = '/images/' + data.pics_name;
          document.getElementById('picture').appendChild(imgElement);
        }

        // タイマーの設定と開始
        var totalSeconds = parseInt(limit_time, 10);
        var minutes = Math.floor(totalSeconds / 60);
        var seconds = totalSeconds % 60;

        // タイマーの表示更新
        document.getElementById('re').innerText = minutes;
        document.getElementById('re3').innerText = seconds;

        var countdownId = setInterval(function() {
          if (minutes === 0 && seconds === 0) {
            clearInterval(countdownId);
          } else {
            if (seconds === 0) {
              minutes--;
              seconds = 59;
            } else {
              seconds--;
            }
            document.getElementById('re').innerText = minutes;
            document.getElementById('re3').innerText = seconds;
          }
        }, 1000);
      });

      // 他のページへの遷移処理
      socket.on('hyouji', function(de) {
        window.location.href = '/hyou3?data=' + encodeURIComponent(de);
      });

      socket.on('result_display2', function(data) {
        window.location.href = '/hyou4';
      });*/
    </script>
  </body>
</html>
